<!DOCTYPE html>
<!-- saved from url=(0060)file:///C:/Users/jlluc/Downloads/villa-booking-gdrive_2.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Villa Caratti Booking System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .auth-section {
            text-align: center;
            padding: 60px 30px;
        }

        .auth-section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .auth-section p {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .google-signin-btn {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: white;
            color: #444;
            border: 2px solid #e0e0e0;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .google-signin-btn:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            border-color: #667eea;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .floor-plan-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
        }

        .upload-btn {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 15px;
            transition: background 0.3s;
        }

        .upload-btn:hover {
            background: #5568d3;
        }

        #floorPlanDisplay {
            margin-top: 20px;
            position: relative;
        }

        #floorPlanDisplay img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .remove-plan-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .bedrooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .bedroom-card {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #667eea;
        }

        .bedroom-card h3 {
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .bedroom-card p {
            color: #666;
            font-size: 0.9em;
        }

        .booking-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .date-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .submit-btn {
            background: #10ac84;
            color: white;
            padding: 14px 32px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }

        .submit-btn:hover {
            background: #0e9670;
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .calendar-grid {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        th, td {
            padding: 12px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .date-header {
            background: #f0f4ff;
            font-weight: 600;
            color: #667eea;
        }

        .bedroom-label {
            font-weight: 600;
            background: #f0f4ff;
            color: #667eea;
            text-align: left;
            padding-left: 15px;
        }

        .booking-cell {
            background: #10ac84;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .booking-cell:hover {
            background: #0e9670;
        }

        .empty-cell {
            background: #f8f9fa;
        }

        .bookings-list {
            display: grid;
            gap: 15px;
        }

        .booking-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            display: grid;
            grid-template-columns: 1fr auto;
            align-items: center;
            gap: 15px;
        }

        .booking-info h3 {
            color: #333;
            margin-bottom: 8px;
        }

        .booking-info p {
            color: #666;
            margin-bottom: 4px;
        }

        .delete-booking-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .delete-booking-btn:hover {
            background: #ff3838;
        }

        .error {
            background: #ff4757;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .success {
            background: #10ac84;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .info-text {
            color: #999;
            text-align: center;
            padding: 40px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 1.2em;
        }

        .sync-status {
            background: #f0f4ff;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sync-status-text {
            color: #667eea;
            font-weight: 600;
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .refresh-btn:hover {
            background: #5568d3;
        }

        .signout-btn {
            background: transparent;
            color: #ff4757;
            border: 2px solid #ff4757;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            margin-left: 10px;
        }

        .signout-btn:hover {
            background: #ff4757;
            color: white;
        }
    </style>
<style id="googleidentityservice_button_styles">.qJTHM{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{overflow-wrap:break-word;word-break:break-word}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-u2z5K{height:36px;width:36px}.Bz112c-uaxL4e{border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf{border:none;margin:0;padding:0}.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u{-webkit-transition:height linear .2s;transition:height linear .2s}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important;-webkit-transition:width linear .3s;transition:width linear .3s}.P1ekSe-ZMv3u>div:nth-child(2){background-image:-webkit-gradient(linear,left top,right top,from(rgba(255,255,255,.7)),to(rgba(255,255,255,.7))),-webkit-gradient(linear,left top,right top,from(#1a73e8),to(#1a73e8))!important;background-image:-webkit-linear-gradient(left,rgba(255,255,255,.7),rgba(255,255,255,.7)),-webkit-linear-gradient(left,#1a73e8,#1a73e8)!important;background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.P1ekSe-ZMv3u>div:nth-child(3){background-image:-webkit-gradient(linear,left top,right top,from(rgba(255,255,255,.7)),to(rgba(255,255,255,.7))),-webkit-gradient(linear,left top,right top,from(#1a73e8),to(#1a73e8))!important;background-image:-webkit-linear-gradient(left,rgba(255,255,255,.7),rgba(255,255,255,.7)),-webkit-linear-gradient(left,#1a73e8,#1a73e8)!important;background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}@media screen and (preferes-contrast:more){.nsm7Bb-HzV7m-LgbsSe{color:#000}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{color:#fff}}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;-webkit-box-align:center;align-items:center;-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;-webkit-box-flex:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;-webkit-box-flex:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:rgb(210,227,252);outline:none}.nsm7Bb-HzV7m-LgbsSe:focus-within{outline:2px solid #00639b;border-color:transparent}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.08)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;-webkit-box-align:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff,.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#000;fill:#000}}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style></head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è Villa Caratti Booking System</h1>
            <p>July 18-31, 2025 | Shared Family Calendar</p>
        </div>

        <div id="authSection" class="auth-section">
            <h2>Welcome! üëã</h2>
            <p>Sign in with Google to access the shared booking calendar.<br>All family members will see the same bookings in real-time.</p>
            <button id="authorizeButton" class="google-signin-btn">
                <svg width="24" height="24" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path>
                </svg>
                Sign in with Google
            </button>
        </div>

        <div id="mainContent" style="display: none;">
            <div class="content">
                <div id="message"></div>
                
                <div class="sync-status">
                    <span class="sync-status-text" id="syncStatus">‚úì Synced with Google Drive</span>
                    <div>
                        <button class="refresh-btn" onclick="loadFromDrive()">üîÑ Refresh</button>
                        <button class="signout-btn" onclick="signOut()">Sign Out</button>
                    </div>
                </div>

                <!-- Floor Plan -->
                <div class="section">
                    <h2>üèõÔ∏è Villa Floor Plan</h2>
                    <div class="floor-plan-section">
                        <label for="floorPlanUpload" class="upload-btn">
                            üìé Upload Floor Plan
                        </label>
                        <input type="file" id="floorPlanUpload" accept="image/*,.pdf" style="display: none;">
                        <div id="floorPlanDisplay">
                            <p class="info-text">Upload a floor plan to help guests choose their rooms</p>
                        </div>
                    </div>
                </div>

                <!-- Bedrooms -->
                <div class="section">
                    <h2>üõèÔ∏è Bedrooms</h2>
                    <div class="bedrooms-grid" id="bedroomsList"></div>
                </div>

                <!-- New Booking Form -->
                <div class="section">
                    <h2>üìÖ New Booking</h2>
                    <div class="booking-form">
                        <div class="form-group">
                            <label>Guest Name(s)</label>
                            <input type="text" id="guestName" placeholder="e.g., John &amp; Sarah Smith" required="">
                        </div>
                        <div class="form-group">
                            <label>Bedroom</label>
                            <select id="bedroomSelect" required="">
                                <option value="">Select a bedroom</option>
                            </select>
                        </div>
                        <div class="date-inputs">
                            <div class="form-group">
                                <label>Check-In Date</label>
                                <input type="date" id="checkIn" min="2025-07-18" max="2025-07-31" required="">
                            </div>
                            <div class="form-group">
                                <label>Check-Out Date</label>
                                <input type="date" id="checkOut" min="2025-07-18" max="2025-07-31" required="">
                            </div>
                        </div>
                        <button class="submit-btn" onclick="addBooking()">Add Booking</button>
                    </div>
                </div>

                <!-- Calendar View -->
                <div class="section">
                    <h2>üìä Calendar Overview</h2>
                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>

                <!-- All Bookings -->
                <div class="section">
                    <h2>üìã All Bookings</h2>
                    <div id="bookingsList" class="bookings-list"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="./Villa Caratti Booking System_files/client" async="" defer=""></script>
    <script>
        // Google API Configuration
        const CLIENT_ID = '42527850730-jbc8asm2rk0euof1p3tkv7mbnrj58ss2.apps.googleusercontent.com';
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
        
        let tokenClient;
        let gapiInited = false;
        let gisInited = false;
        let accessToken = null;
        let dataFileId = null;
        
        const bedrooms = [
            { id: '1', name: 'Bedroom 1', details: 'Lake Suite - Double, En-suite' },
            { id: '2', name: 'Bedroom 2', details: 'Lake Suite - Double, En-suite' },
            { id: '3', name: 'Bedroom 3', details: 'Lake Suite - Double, Shared bathroom' },
            { id: '4', name: 'Bedroom 4', details: 'Lake Suite - Twin beds, Shared bathroom' },
            { id: '5', name: 'Bedroom 5', details: 'Sky Suite - Double, En-suite' },
            { id: '6', name: 'Bedroom 6', details: 'Sky Suite - Double, En-suite' },
            { id: '7', name: 'Bedroom 7', details: 'Sky Suite - Double, En-suite' },
            { id: '8', name: 'Bedroom 8', details: 'Sky Suite - Single, En-suite' },
            { id: '9', name: 'Bedroom 9', details: 'Sky Suite - Single, En-suite' }
        ];
        
        let bookings = [];
        let floorPlanData = null;

        function getDates() {
            const dates = [];
            for (let day = 18; day <= 31; day++) {
                dates.push(`2025-07-${day.toString().padStart(2, '0')}`);
            }
            return dates;
        }

        const dates = getDates();

        // Initialize Google API
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            await gapi.client.init({
                discoveryDocs: [DISCOVERY_DOC],
            });
            gapiInited = true;
            maybeEnableButtons();
        }

        function gisLoaded() {
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CLIENT_ID,
                scope: SCOPES,
                callback: '',
            });
            gisInited = true;
            maybeEnableButtons();
        }

        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                document.getElementById('authorizeButton').style.visibility = 'visible';
            }
        }

        // Handle authorization
        function handleAuthClick() {
            tokenClient.callback = async (resp) => {
                if (resp.error !== undefined) {
                    throw (resp);
                }
                accessToken = gapi.client.getToken().access_token;
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                await initializeApp();
            };

            if (gapi.client.getToken() === null) {
                tokenClient.requestAccessToken({prompt: 'consent'});
            } else {
                tokenClient.requestAccessToken({prompt: ''});
            }
        }

        // Sign out
        function signOut() {
            const token = gapi.client.getToken();
            if (token !== null) {
                google.accounts.oauth2.revoke(token.access_token);
                gapi.client.setToken('');
                document.getElementById('mainContent').style.display = 'none';
                document.getElementById('authSection').style.display = 'block';
            }
        }

        // Initialize app
        async function initializeApp() {
            await loadFromDrive();
            renderBedrooms();
            renderBedroomSelect();
            renderCalendar();
            renderBookingsList();
            setupFloorPlanUpload();
        }

        // Load data from Google Drive
        async function loadFromDrive() {
            try {
                updateSyncStatus('Loading from Google Drive...');
                
                // Search for our data file
                const response = await gapi.client.drive.files.list({
                    q: "name='villa-caratti-bookings.json' and trashed=false",
                    spaces: 'drive',
                    fields: 'files(id, name)',
                });

                const files = response.result.files;
                
                if (files && files.length > 0) {
                    dataFileId = files[0].id;
                    
                    // Download the file content
                    const fileResponse = await gapi.client.drive.files.get({
                        fileId: dataFileId,
                        alt: 'media',
                    });
                    
                    const data = JSON.parse(fileResponse.body);
                    bookings = data.bookings || [];
                    floorPlanData = data.floorPlan || null;
                    
                    if (floorPlanData) {
                        displayFloorPlan(floorPlanData);
                    }
                } else {
                    // Create new file
                    await saveToDrive();
                }
                
                updateSyncStatus('‚úì Synced with Google Drive');
            } catch (error) {
                console.error('Error loading from Drive:', error);
                showMessage('Error loading data from Google Drive', 'error');
                updateSyncStatus('‚ö† Sync error');
            }
        }

        // Save data to Google Drive
        async function saveToDrive() {
            try {
                updateSyncStatus('Saving to Google Drive...');
                
                const data = {
                    bookings: bookings,
                    floorPlan: floorPlanData,
                    lastUpdated: new Date().toISOString()
                };

                const fileContent = JSON.stringify(data, null, 2);
                const file = new Blob([fileContent], { type: 'application/json' });
                
                const metadata = {
                    name: 'villa-caratti-bookings.json',
                    mimeType: 'application/json',
                };

                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
                form.append('file', file);

                let response;
                if (dataFileId) {
                    // Update existing file
                    response = await fetch(`https://www.googleapis.com/upload/drive/v3/files/${dataFileId}?uploadType=multipart`, {
                        method: 'PATCH',
                        headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),
                        body: form,
                    });
                } else {
                    // Create new file
                    response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                        method: 'POST',
                        headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),
                        body: form,
                    });
                }

                const result = await response.json();
                if (result.id) {
                    dataFileId = result.id;
                }
                
                updateSyncStatus('‚úì Synced with Google Drive');
            } catch (error) {
                console.error('Error saving to Drive:', error);
                showMessage('Error saving to Google Drive', 'error');
                updateSyncStatus('‚ö† Sync error');
            }
        }

        function updateSyncStatus(text) {
            document.getElementById('syncStatus').textContent = text;
        }

        // Setup floor plan upload
        function setupFloorPlanUpload() {
            document.getElementById('floorPlanUpload').addEventListener('change', async function(e) {
                const file = e.target.files[0];
                if (!file) return;

                if (file.size > 5 * 1024 * 1024) {
                    showMessage('Floor plan file is too large. Please use a file under 5MB.', 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = async function(event) {
                    floorPlanData = event.target.result;
                    displayFloorPlan(floorPlanData);
                    await saveToDrive();
                    showMessage('Floor plan uploaded successfully!', 'success');
                };
                reader.readAsDataURL(file);
            });
        }

        function displayFloorPlan(dataUrl) {
            const display = document.getElementById('floorPlanDisplay');
            display.innerHTML = `
                <div style="position: relative;">
                    <img src="${dataUrl}" alt="Villa Floor Plan">
                    <button class="remove-plan-btn" onclick="removeFloorPlan()">Remove</button>
                </div>
            `;
        }

        async function removeFloorPlan() {
            if (!confirm('Remove the floor plan?')) return;
            floorPlanData = null;
            document.getElementById('floorPlanDisplay').innerHTML = '<p class="info-text">Upload a floor plan to help guests choose their rooms</p>';
            await saveToDrive();
            showMessage('Floor plan removed', 'success');
        }

        async function addBooking() {
            const guestName = document.getElementById('guestName').value.trim();
            const bedroomId = document.getElementById('bedroomSelect').value;
            const checkIn = document.getElementById('checkIn').value;
            const checkOut = document.getElementById('checkOut').value;

            if (!guestName || !bedroomId || !checkIn || !checkOut) {
                showMessage('Please fill in all fields', 'error');
                return;
            }

            if (checkIn >= checkOut) {
                showMessage('Check-out date must be after check-in date', 'error');
                return;
            }

            const conflict = bookings.find(b => 
                b.bedroomId === bedroomId &&
                !(checkOut <= b.checkIn || checkIn >= b.checkOut)
            );

            if (conflict) {
                showMessage('This bedroom is already booked for overlapping dates', 'error');
                return;
            }

            bookings.push({
                id: Date.now().toString(),
                guestName,
                bedroomId,
                checkIn,
                checkOut
            });

            await saveToDrive();
            
            document.getElementById('guestName').value = '';
            document.getElementById('bedroomSelect').value = '';
            document.getElementById('checkIn').value = '';
            document.getElementById('checkOut').value = '';
            
            renderCalendar();
            renderBookingsList();
            showMessage('Booking added successfully!', 'success');
        }

        async function deleteBooking(id) {
            if (!confirm('Are you sure you want to delete this booking?')) {
                return;
            }

            bookings = bookings.filter(b => b.id !== id);
            await saveToDrive();
            renderCalendar();
            renderBookingsList();
            showMessage('Booking deleted', 'success');
        }

        function renderBedrooms() {
            const container = document.getElementById('bedroomsList');
            container.innerHTML = bedrooms.map(bedroom => `
                <div class="bedroom-card">
                    <h3>${bedroom.name}</h3>
                    <p>${bedroom.details}</p>
                </div>
            `).join('');
        }

        function renderBedroomSelect() {
            const select = document.getElementById('bedroomSelect');
            select.innerHTML = '<option value="">Select a bedroom</option>' + 
                bedrooms.map(b => `<option value="${b.id}">${b.name} - ${b.details}</option>`).join('');
        }

        function renderCalendar() {
            const container = document.getElementById('calendarGrid');

            let html = '<table><thead><tr><th>Bedroom</th>';
            dates.forEach(date => {
                const d = new Date(date + 'T00:00:00');
                const day = d.getDate();
                const month = d.toLocaleDateString('en-US', { month: 'short' });
                html += `<th class="date-header">${month} ${day}</th>`;
            });
            html += '</tr></thead><tbody>';

            bedrooms.forEach(bedroom => {
                html += `<tr><td class="bedroom-label">${bedroom.name}</td>`;
                
                dates.forEach(date => {
                    const booking = bookings.find(b => 
                        b.bedroomId === bedroom.id &&
                        date >= b.checkIn &&
                        date < b.checkOut
                    );

                    if (booking) {
                        html += `<td class="booking-cell" onclick="deleteBooking('${booking.id}')" title="Click to delete: ${booking.guestName}">${booking.guestName.split(' ')[0]}</td>`;
                    } else {
                        html += `<td class="empty-cell">‚Äî</td>`;
                    }
                });
                
                html += '</tr>';
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function renderBookingsList() {
            const container = document.getElementById('bookingsList');
            
            if (bookings.length === 0) {
                container.innerHTML = '<p class="info-text">No bookings yet</p>';
                return;
            }

            const sortedBookings = [...bookings].sort((a, b) => a.checkIn.localeCompare(b.checkIn));

            container.innerHTML = sortedBookings.map(booking => {
                const bedroom = bedrooms.find(b => b.id === booking.bedroomId);
                const checkInDate = new Date(booking.checkIn + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                const checkOutDate = new Date(booking.checkOut + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                
                return `
                    <div class="booking-item">
                        <div class="booking-info">
                            <h3>${booking.guestName}</h3>
                            <p><strong>Room:</strong> ${bedroom ? bedroom.name + ' - ' + bedroom.details : 'Unknown'}</p>
                            <p><strong>Dates:</strong> ${checkInDate} - ${checkOutDate}</p>
                        </div>
                        <button class="delete-booking-btn" onclick="deleteBooking('${booking.id}')">Delete</button>
                    </div>
                `;
            }).join('');
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.className = type;
            messageDiv.textContent = text;
            messageDiv.style.display = 'block';
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 4000);
        }

        // Initialize when page loads
        window.onload = () => {
            document.getElementById('authorizeButton').addEventListener('click', handleAuthClick);
        };

        // Load Google API
        gapiLoaded();
        gisLoaded();
    </script>


</body></html>